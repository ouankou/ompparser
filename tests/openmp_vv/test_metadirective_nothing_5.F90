!$omp     begin metadirective when(device={kind(nohost)}: nothing) when(device={arch("nvptx")}: nothing) when(implementation={vendor(amd)}: nothing) default(parallel do num_threads(max_num_threads_target+1))
